[tox]
envlist = py39, py310, py311, lint, type-check
isolated_build = True

[testenv]
deps =
    pytest>=7.0.0
    pytest-asyncio>=0.21.0
    pytest-cov>=4.0.0
    pytest-mock>=3.10.0
    pytest-xdist>=3.0.0
    httpx>=0.24.0
    fastapi>=0.100.0
    uvicorn>=0.22.0
    celery>=5.3.0
    redis>=4.6.0
    sqlalchemy>=2.0.0
    alembic>=1.11.0
    pandas>=2.0.0
    numpy>=1.24.0
    scipy>=1.10.0
    plotly>=5.15.0
    mygene>=3.2.0
    requests>=2.31.0
    loguru>=0.7.0
    pydantic>=2.0.0
    click>=8.1.0
    typer>=0.9.0
    rich>=13.0.0
    pyyaml>=6.0
    python-multipart>=0.0.6
    python-jose[cryptography]>=3.3.0
    passlib[bcrypt]>=1.7.4
    python-dotenv>=1.0.0
    aiofiles>=23.0.0
    jinja2>=3.1.0
    markupsafe>=2.1.0
    itsdangerous>=2.1.0
    email-validator>=2.0.0
    python-multipart>=0.0.6
    python-jose[cryptography]>=3.3.0
    passlib[bcrypt]>=1.7.4
    python-dotenv>=1.0.0
    aiofiles>=23.0.0
    jinja2>=3.1.0
    markupsafe>=2.1.0
    itsdangerous>=2.1.0
    email-validator>=2.0.0
commands =
    pytest {posargs:tests/} --cov=pathwaylens_core --cov=pathwaylens_api --cov=pathwaylens_cli --cov-report=term-missing --cov-report=html

[testenv:lint]
deps =
    flake8>=6.0.0
    black>=23.0.0
    isort>=5.12.0
    mypy>=1.4.0
commands =
    flake8 pathwaylens_core/ pathwaylens_api/ pathwaylens_cli/ --max-line-length=100 --extend-ignore=E203,W503
    black --check --diff pathwaylens_core/ pathwaylens_api/ pathwaylens_cli/
    isort --check-only --diff pathwaylens_core/ pathwaylens_api/ pathwaylens_cli/

[testenv:type-check]
deps =
    mypy>=1.4.0
    types-requests>=2.31.0
    types-PyYAML>=6.0.0
    types-redis>=4.6.0
commands =
    mypy pathwaylens_core/ pathwaylens_api/ pathwaylens_cli/ --ignore-missing-imports

[flake8]
max-line-length = 100
extend-ignore = E203, W503
exclude = 
    .git,
    __pycache__,
    .venv,
    venv,
    .tox,
    build,
    dist,
    *.egg-info,
    .pytest_cache,
    .coverage,
    htmlcov

[isort]
profile = black
multi_line_output = 3
line_length = 100
known_first_party = pathwaylens_core, pathwaylens_api, pathwaylens_cli
known_third_party = pytest, fastapi, uvicorn, celery, redis, sqlalchemy, alembic, pandas, numpy, scipy, plotly, mygene, requests, loguru, pydantic, click, typer, rich, pyyaml, python_multipart, python_jose, passlib, python_dotenv, aiofiles, jinja2, markupsafe, itsdangerous, email_validator, httpx, pytest_asyncio, pytest_cov, pytest_mock, pytest_xdist

[mypy]
python_version = 3.9
warn_return_any = True
warn_unused_configs = True
disallow_untyped_defs = True
disallow_incomplete_defs = True
check_untyped_defs = True
disallow_untyped_decorators = True
no_implicit_optional = True
warn_redundant_casts = True
warn_unused_ignores = True
warn_no_return = True
warn_unreachable = True
strict_equality = True
ignore_missing_imports = True
